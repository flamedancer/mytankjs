<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" charset="utf-8" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <meta name="description" content="魔力坦克H5版本">
    <meta name="author" content="flame">
    <!-- <link rel="icon" href="../../favicon.ico"> -->

    <title>魔力坦克H5版本</title>

    <!-- Bootstrap core CSS -->
    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->

    <!-- Custom styles for this template -->
    <!-- <link href="starter-template.css" rel="stylesheet"> -->

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <nav class="navbar navbar-inverse">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">《魔力坦克ONLINE》</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">主页</a></li>
            <!-- <li><a href="#about"></a></li> -->
            <li><a href="#contact">联系我</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

  <div class="container">

    <div class="row container-fluid" >
      <div class="col-md-4 ">
        <div  id="romm_table">
<!--           <div class="row room" id='title'>
              《魔力坦克ONLINE》
          </div> -->
          <div class="row" id='self_room'></div>
          <div class="row">
            <div class="col-md-4 room can_click" onclick="join(0);">
                  单机练习
            </div>
            <div class="col-md-4 room can_click" onclick="join(2, '');">
                  新建房间
            </div>
            <div class="col-md-4 room">
                  Ping:<span class="label label-default" id="self_ping">35</span>ms
            </div>
          </div>
          <div class="row">
            <div class="col-md-12 room">
              <div class="row">
                <div class="col-md-3 room">
                  房间号
                </div>
                <div class="col-md-3 room">
                  玩家数
                </div>
                <div class="col-md-3 room">
                  ping
                </div>
                <div class="col-md-3 room can_click" onclick="join(2, '-1')">
                 快速加入
                </div>
              </div>
            </div>
          </div>

        </div>
        <div class="panel panel-default" id="plan-desc">
          <div class="panel-heading">
            <h3 class="panel-title">玩法介绍:</h3>
          </div>
          <div class="panel-body">
            
  <pre>
  1. 需pc端浏览器打开本页
  2. 移动键 W A S D
  3. 攻击键 J
  4. 联网玩法：
    * 点击 <新建房间> 可创建联网房间
    * 点击 <加入> 可加入其他玩家创建的房间
    * 或点击 <快速加入>，快速联网游戏
            </pre>
          </div>
        </div>
      </div>
      <div class="col-md-5">
        <div id="game"></div>
<!--         <div class="progress">
          <div id="bosshps" class="progress-bar progress-bar-danger" role="progressbar" >
          </div>
        </div> -->
      </div>
        <div class="col-md-3" id="contactme">
            <div class="row">
                <div class="panel panel-default">
                  <div class="panel-heading">简介</div>
                  <div class="panel-body">
                  欢迎各位数值、策划、美术、程序等大神吐槽
                  </div>
                </div>
            </div>
            <div class="row" id="weixinmsg">
            联系我(微信)：
            </div>
            <div class="row" id="weixindiv">
                <img src="assets/myweixin.png" id="weixin">
            </div>
            <div class="row" id="chatlink">
                <a href="http://flamedancer.cn:7000/" target="_blank">吐槽请点我-_-</a>
            </div>
        </div>
    </div>


  </div><!-- /.container -->


<div class='footer'>
©2020 flamedancer.cn 版权所有 ICP证书: <a href="https://beian.miit.gov.cn">赣ICP备19002208号</a>
</div>
</body>
<!--
<script
  src="https://lib.baomitu.com/jquery/3.3.1/jquery.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous">
</script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
-->
<style type="text/css"> 
/*body{ text-align:center} */
.button_span {width: 100%;}
/*#romm_table {margin-top:5%;}*/
#game{ margin:0 auto; border:1px solid blue;} 
.room { margin:0 auto; border:1px solid #0000CD;text-align:center;}

#title {font-size:larger}
#weixin {max-width: 150px; max-height:150px;}
#contactme {text-align:center;}
#chatlink {padding: 20%;}
.can_click {font-weight: bold;font-style:oblique;color:red;text-decoration:blink; }
.can_click:link    {color:blue;}
.can_click:visited {color:blue;}
.can_click:hover   {color:red; cursor:pointer;}
.can_click:active  {color:yellow;}

.footer {
    text-align: center;
    font-size: 13px;
    margin-top: 200px;
}
#plan-desc {
  margin-top: 100px;
}
</style>

<script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<script type="text/javascript" src="crafty-min.js"></script>
<script type="text/javascript" src="conf.js"></script>
<script type="text/javascript" src="tool.js"></script>
<script type="text/javascript" src="assets/maps/mapjs.js"></script>
<script type="text/javascript" src="libs.js"></script>
<script type="text/javascript" src="control.js"></script>
<script type="text/javascript" src="socket.js"></script>
<script type="text/javascript" src="stage.js"></script>
<script type="text/javascript" src="bullet.js"></script>
<script type="text/javascript" src="tanks.js"></script>

<script type="text/javascript">
    function show_self_ping(ping_value) {
      $("#self_ping").html(ping_value);
    }


    function addRoom(room_id, room_index, ping) {
        var ping = ping ? ping.toString() : "--";
      var txt1=$("<div></div>");            // 以 HTML 创建新元素
      var txt2=$("<div></div>");  // 以 jQuery 创建新元素
      var txt3=$("<div></div>");  // 以 DOM 创建新元素
      var txt4=$("<div></div>");
      var row=$("<div></div>");
      row.attr("class", "row");
      row.attr("room_index", room_index);
      txt1.attr("class", "col-md-3 room");
      txt2.attr("class", "col-md-3 room");
      txt3.attr("class", "col-md-3 room");
      txt4.attr("class", "col-md-3 room can_click");
      txt4.attr("onclick", "join(2, '" + room_id.toString() + "')");
      txt1.html(room_index);
      txt2.html("1/2");
      txt3.html(ping + "ms");
      txt4.html("加入");
      row.append(txt1,txt2,txt3,txt4); 
      $("#romm_table").append(row);
    }

    function add_rooms(infs) {
        $("[room_index]").each(function(i) {
            this.remove();
        });
        for (var index in infs ) {
            // 可能有空房间
            if (infs[index]) {
                var room_id = infs[index][0];
                var room_ping = infs[index][1];
                addRoom(room_id, index, room_ping);
            }
        }
    }

    function delRoom(room_index) {
      $("[room_index='"+ room_index +"']").remove();
    }

    function reset_room(room_index, type, value) {
      if (type == "num") {
        if (value == 1)
          $("[room_index='"+ room_index +"']").children(".col-md-3")[3].innerHTML = "加入";
        else
          $("[room_index='"+ room_index +"']").children(".col-md-3")[3].innerHTML = "";
          $("[room_index='"+ room_index +"']").children(".col-md-3")[1].innerHTML = value.toString()+"/2";
      }
      else if (type == "ping")
          $("[room_index='"+ room_index +"']").children(".col-md-3")[2].innerHTML = value.toString()+"ms";
      else if (type == "del")
        delRoom(room_index);
      else if (type == "add")
        addRoom(value, room_index);
    }

    function join(game_model, room_id) {
      start_game(game_model, room_id);
    }

    function show_self_room(room_index) {
        if (typeof room_index == "undefined") {
            $("#self_room").html("");
        }
        else {
            var info = "正在房间：" + room_index.toString();
            $("#self_room").html(info);
        }
    }

    Crafty.init(SCREEN_WIDTH, SCREEN_HEIGHT, document.getElementById('game'));
    join(0);
</script>
</html>
